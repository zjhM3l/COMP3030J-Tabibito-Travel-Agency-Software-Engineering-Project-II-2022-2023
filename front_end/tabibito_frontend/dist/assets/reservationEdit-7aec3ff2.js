import{_ as e,r as t,D as a,u as l,a as i,o as s,c as n,d as r,b as u,w as o,k as d,v as c,n as p,h as m,F as h,e as v,G as b,p as g,j as y}from"./index-6bfe40dc.js";import{P as D,R as _}from"./priceItem-532bcbf5.js";const f={name:"projectManagementDetailView",components:{PriceItem:D,RouteStep:_},setup(){let e=t("Basic Information");const l=a();let i=t(null),s=t(null),n=t([{key:null,value:""},{key:null,value:""},{key:null,value:""}]),r=null;let u=[];let o=[];let d=t([]),c=t("disabled_btn"),p=t(),m=t(!1),h=t([]);return{tabValue:e,resetInput(e){e.currentTarget.classList.contains("invalidInput")&&e.currentTarget.classList.remove("invalidInput")},startTime:i,endTime:s,tags:n,coverImageList:t([]),bannerImageList:t([]),galleryList:t([]),coverImage:r,handleFinishCover:({file:e,event:t})=>{let a=(null==t?void 0:t.target).response;r=a},bannerImages:u,handleFinishBanner:({file:e,event:t})=>{let a=(null==t?void 0:t.target).response;u.push(a)},galleryImages:o,handleFinishGallery:({file:e,event:t})=>{let a=(null==t?void 0:t.target).response;o.push(a)},async beforeUpload(e){var t;let a=null==(t=e.file.file)?void 0:t.type;return!!/image/.test(a)||(l.error("You can only upload images."),!1)},secureStartTime:e=>null!=s.value?e<Date.now()||e>s.value:e<Date.now(),secureEndTime:e=>null!=i.value?e<Date.now()||e<i.value:e<Date.now(),tagOptions:t([{label:"Price",value:"Price"},{label:"Hotel",value:"Hotel"},{label:"Scenery",value:"Scenery"},{label:"Transportation Method",value:"Transportation Method"},{label:"Country",value:"Country"}]),routeDatas:d,totalDayNumber:p,totalDayNumberDisabled:m,add_step_status:c,checkAddStepStatus(){if(null!==p.value&&0!==p.value&&"0"!==p.value){new RegExp("\\D").test(p.value)?c.value="disabled_btn":c.value=""}else c.value="disabled_btn"},addStep(){"disabled_btn"===c.value?l.error("Please Enter total day number at first."):(0===d.value.length&&(m.value=!0),d.value.push({totalDayNumber:p.value,activityName:"",exactLocation:"",mapLatitude:"",mapLongitude:"",mapZoom:"",dayNumber:null,periodValue:"Morning",exactTime:null,activityPic:""}))},chargeDatas:h,currencyType:t("USD"),currencyOptions:t([{label:"USD",value:"USD"},{label:"EUR",value:"EUR"},{label:"CNY",value:"CNY"}]),addCharge(){h.value.push({chargeName:"",chargeDescription:""})}}},data:()=>({projectName:null,projectNameStyle:null,projectDescription:null,groupNumber:null,typeList:[],cutoffDate:null,locationText:null,mapLatitude:null,mapLongitude:null,mapZoom:null,originalPrice:null,discount:null,originalPriceStyle:null}),methods:{validateInteger(e,t,a){new RegExp("\\D").test(t)&&(this[a]="",e.currentTarget.classList.add("invalidInput"))},validateNumber(e,t,a){/^[0-9]+([.]{1}[0-9]+){0,1}$/.test(t)||(this[a]="",e.currentTarget.classList.add("invalidInput"))},handleChooseType(e,t){-1!==this.typeList.indexOf(e)?(t.currentTarget.classList.remove("selectedType"),this.typeList.splice(this.typeList.indexOf(e),1)):(t.currentTarget.classList.add("selectedType"),this.typeList.push(e))},handleDeleteStep(e){this.routeDatas.splice(e,1),0===this.routeDatas.length&&(this.totalDayNumberDisabled=!1)},handleDeleteCharge(e){this.chargeDatas.splice(e,1)},submitForm(){const e=l();if(""===this.tags[0].value||""===this.tags[1].value||""===this.tags[2].value)return this.tabValue="Basic Information",void e.error("Please enter all the three tags");if(null===this.projectName||""===this.projectName)return this.tabValue="Basic Information",void(this.projectNameStyle="invalidInput");if(null===this.originalPrice||""===this.originalPrice)return this.tabValue="Price",void(this.originalPriceStyle="invalidInput");let t=[];for(let l=0;l<this.routeDatas.length;l++)t.push({location:{exact:this.routeDatas[l].exactLocation,map_latitude:this.routeDatas[l].mapLatitude,map_longitude:this.routeDatas[l].mapLongitude,map_zoom:this.routeDatas[l].mapZoom},time:this.routeDatas[l].exactTime,activity:this.routeDatas[l].activityName,picture:this.routeDatas[l].activityPic,day:this.routeDatas[l].dayNumber,time_of_day:this.routeDatas[l].periodValue});let a=[];for(let l=0;l<this.chargeDatas.length;l++)a.push({name:this.chargeDatas[l].chargeName,description:this.chargeDatas[l].chargeDescription});this.axios.post("/product/add",{name:this.projectName,description:this.projectDescription,group_number:this.groupNumber,location:{raw_loc:this.locationText,map_latitude:this.mapLatitude,map_longitude:this.mapLongitude,map_zoom:this.mapZoom},discount:this.discount,ori_price:this.originalPrice,currency:this.currencyType,tags:this.tags,cover_image:this.coverImage,banner_image:this.bannerImages,gallery:this.galleryImages,start_time:this.startTime,end_time:this.endTime,app_ddl:this.cutoffDate,fee_des:a,trips:t,types:this.typeList})}}},T=e=>(g("data-v-2eb9ae71"),e=e(),y(),e),S={class:"bg"},x={class:"container"},N=T((()=>r("div",{class:"titlePart"},[r("div",{class:"titleMain"},[r("h1",{class:"mainTitle"},"Edit Reservation"),r("div",{class:"slogan"},"Edit the reservation details and announce the changes to the customers.")])],-1))),I={class:"settings"},L={class:"tabInnerContainer"},P=T((()=>r("div",{class:"inputTitle"},"Travel Time Detail",-1))),C={class:"dataPickers"},U=T((()=>r("p",{class:"note"}," * New travel time will be announced to the booking holder once it's changed.",-1))),k=T((()=>r("div",{class:"inputTitle"},"Total Day Number",-1))),V={class:"input_form"},j=["disabled"],w=T((()=>r("label",{class:"input_label"},"Total Day Number",-1))),R=T((()=>r("div",{class:"icon_add"},null,-1))),E=T((()=>r("div",{class:"inputTitle"},"Original Price",-1))),F={class:"input_form"},B=T((()=>r("label",{class:"input_label"},"Original Price",-1))),z=T((()=>r("div",{class:"inputTitle"},"Discount",-1))),O={class:"input_form"},A=T((()=>r("label",{class:"input_label"},"Discount",-1))),M=T((()=>r("div",{class:"icon_add"},null,-1))),q={class:"tabInnerContainer"},Z=T((()=>r("div",{class:"inputTitle"},"Reason",-1))),Y={class:"input_form"},G=T((()=>r("label",{class:"input_label"},"Reasons for changing the reservation",-1))),H=T((()=>r("div",{class:"icon_submit"},null,-1)));const $=e(f,[["render",function(e,t,a,l,g,y){const D=i("n-date-picker"),_=i("n-tab-pane"),f=i("route-step"),T=i("n-select"),$=i("price-item"),J=i("n-tabs");return s(),n("div",S,[r("div",x,[N,r("div",I,[u(J,{value:l.tabValue,"onUpdate:value":t[17]||(t[17]=e=>l.tabValue=e),class:"card-tabs",size:"large",animated:"",style:{margin:"0 -4px"},"pane-style":"padding-left: 4px; padding-right: 4px; box-sizing: border-box;"},{default:o((()=>[u(_,{name:"Basic Information",tab:"1. Basic Information"},{default:o((()=>[r("div",L,[P,r("div",C,[u(D,{value:l.startTime,"onUpdate:value":t[0]||(t[0]=e=>l.startTime=e),type:"date","is-date-disabled":l.secureStartTime,size:"large",clearable:"",placeholder:"Start Date"},null,8,["value","is-date-disabled"]),u(D,{value:l.endTime,"onUpdate:value":t[1]||(t[1]=e=>l.endTime=e),type:"date",placement:"bottom-end","is-date-disabled":l.secureEndTime,size:"large",clearable:"",placeholder:"End Date"},null,8,["value","is-date-disabled"])])]),U])),_:1}),u(_,{name:"Route",tab:"2. Route"},{default:o((()=>[k,r("div",V,[d(r("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>l.totalDayNumber=e),disabled:l.totalDayNumberDisabled,required:"",onChange:t[3]||(t[3]=(...e)=>l.checkAddStepStatus&&l.checkAddStepStatus(...e)),onBlur:t[4]||(t[4]=e=>y.validateInteger(e,l.totalDayNumber,"totalDayNumber")),onFocus:t[5]||(t[5]=e=>l.resetInput(e))},null,40,j),[[c,l.totalDayNumber]]),w]),r("button",{type:"submit",class:p(["add_step_btn",l.add_step_status]),onClick:t[6]||(t[6]=(...e)=>l.addStep&&l.addStep(...e))},[R,m(" Add Step ")],2),(s(!0),n(h,null,v(l.routeDatas,((e,t)=>(s(),n("div",null,[u(f,{"step-data":e,"step-index":t,onDeleteStep:e=>y.handleDeleteStep(t)},null,8,["step-data","step-index","onDeleteStep"])])))),256))])),_:1}),u(_,{name:"Price",tab:"3. Price"},{default:o((()=>[E,r("div",F,[d(r("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>g.originalPrice=e),required:"",style:b(g.originalPriceStyle),onBlur:t[8]||(t[8]=e=>y.validateNumber(e,g.originalPrice,"originalPrice")),onFocus:t[9]||(t[9]=e=>l.resetInput(e))},null,36),[[c,g.originalPrice]]),B,u(T,{value:l.currencyType,"onUpdate:value":t[10]||(t[10]=e=>l.currencyType=e),size:"large",options:l.currencyOptions,placeholder:"Select Currency Unit",style:{width:"200px","margin-left":"10px"}},null,8,["value","options"])]),z,r("div",O,[d(r("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=e=>g.discount=e),required:"",onBlur:t[12]||(t[12]=e=>y.validateNumber(e,g.discount,"discount")),onFocus:t[13]||(t[13]=e=>l.resetInput(e))},null,544),[[c,g.discount]]),A]),r("button",{type:"submit",class:"add_step_btn",onClick:t[14]||(t[14]=(...e)=>l.addCharge&&l.addCharge(...e))},[M,m(" Add Charge ")]),(s(!0),n(h,null,v(l.chargeDatas,((e,t)=>(s(),n("div",null,[u($,{"item-data":e,"item-index":t,onDeleteCharge:e=>y.handleDeleteCharge(t)},null,8,["item-data","item-index","onDeleteCharge"])])))),256))])),_:1}),u(_,{name:"Location",tab:"4. Reason"},{default:o((()=>[r("div",q,[Z,r("div",Y,[d(r("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=e=>g.locationText=e),required:""},null,512),[[c,g.locationText]]),G])])])),_:1}),u(_,{name:"Submit",tab:"5. Submit"},{default:o((()=>[r("button",{type:"submit",class:"add_step_btn",onClick:t[16]||(t[16]=(...e)=>y.submitForm&&y.submitForm(...e))},[m(" Submit "),H])])),_:1})])),_:1},8,["value"])])])])}],["__scopeId","data-v-2eb9ae71"]]);export{$ as default};
